(this.webpackJsonppoemandtravel=this.webpackJsonppoemandtravel||[]).push([[4],{633:function(e,t,a){e.exports=a.p+"static/media/markerleaflet.c9a982f4.svg"},634:function(e,t,a){e.exports=a.p+"static/media/markerleaflet-active.c3ddafda.svg"},644:function(e,t,a){e.exports=a.p+"static/media/markerleaflet-small.c41523ae.svg"},645:function(e,t,a){e.exports=a.p+"static/media/markerleaflet-active-small.9a6f0984.svg"},668:function(e,t,a){e.exports={SearchInput:"SearchForm_SearchInput__AEH8N"}},669:function(e,t,a){e.exports={Container:"ResultPageTopBar_Container__OosJD",Category:"ResultPageTopBar_Category__2WsM6"}},670:function(e,t,a){e.exports={Container:"ResultPageInfoBar_Container__S4VP0",Toggle:"ResultPageInfoBar_Toggle__2XYqS"}},675:function(e,t,a){e.exports={Container:"Review_Container__14Coy",Score:"Review_Score__2hzpT",Number:"Review_Number__dNvCU"}},676:function(e,t,a){e.exports={Tag:"Tag_Tag__2uLIq"}},677:function(e,t,a){e.exports={Container:"Location_Container__ANHFz",Text:"Location_Text__GG1YI"}},678:function(e,t,a){e.exports={Container:"ResultOrder_Container__1_Oht",Order:"ResultOrder_Order__1EbGF"}},679:function(e,t,a){e.exports={CardRoot:"ResultCard_CardRoot__2iteN",CardLink:"ResultCard_CardLink__O3d6F",CardActionArea:"ResultCard_CardActionArea__24wHh",CardContent:"ResultCard_CardContent__1D2cw",CardActions:"ResultCard_CardActions__1z_He",ContentLeft:"ResultCard_ContentLeft__1rdtd",ContentRight:"ResultCard_ContentRight__1DvQF",ContentLeftBottom:"ResultCard_ContentLeftBottom__2C-lW",ContentRightBottom:"ResultCard_ContentRightBottom__3AgMH",Intro:"ResultCard_Intro__35HCd",Media:"ResultCard_Media__3STQs",ShareButton:"ResultCard_ShareButton__1GiX7",Info:"ResultCard_Info__1DKLC",Author:"ResultCard_Author__3qIUX",Title:"ResultCard_Title__13O3l",Written:"ResultCard_Written__1ufpt",Time:"ResultCard_Time__2hR01",TagContainer:"ResultCard_TagContainer__f-yv6"}},680:function(e,t,a){e.exports={Skeletons:"ResultList_Skeletons__3u_NP",Skeleton:"ResultList_Skeleton__35xQo"}},681:function(e,t,a){e.exports={Container:"InfoWindow_Container__Geaw3",Author:"InfoWindow_Author__2DJgj",TitleRow:"InfoWindow_TitleRow__2tuT1",Title:"InfoWindow_Title__1Owkl",FlexRow:"InfoWindow_FlexRow__qwTNi",AuthorRow:"InfoWindow_AuthorRow__3oFz5",TagRow:"InfoWindow_TagRow__3xZZ1",TagDiv:"InfoWindow_TagDiv__U0nCX",BottomRow:"InfoWindow_BottomRow__FtApo",Date:"InfoWindow_Date__3b0Nt",Price:"InfoWindow_Price__3W0sk",Time:"InfoWindow_Time__2E9bH"}},682:function(e,t,a){e.exports={Container:"LoadingDots_Container__2I4vD",Dot:"LoadingDots_Dot__kb9_R",dots:"LoadingDots_dots__2d_fE"}},683:function(e,t,a){e.exports={Container:"ReSearchBounds_Container__1KAF9",Pos1:"ReSearchBounds_Pos1__3DLUQ",Pos2:"ReSearchBounds_Pos2__12afO"}},684:function(e,t,a){e.exports={GoogleUnavailable:"ResultMap_GoogleUnavailable__3j6WD",Can:"ResultMap_Can__1pKtD"}},685:function(e,t,a){e.exports={Icon:"LeafletMarkerIcon_Icon__zWm3b",IconActive:"LeafletMarkerIcon_IconActive__1Ol-X"}},686:function(e,t,a){e.exports={Tooltip:"ResultMarkerLeaflet_Tooltip__2DCVp"}},690:function(e,t,a){e.exports={Container:"ResultPage_Container__36kb3",Results:"ResultPage_Results__QC6Q0",ResultsWrap:"ResultPage_ResultsWrap__3zUab",SearchBar:"ResultPage_SearchBar__19JPt",Bar:"ResultPage_Bar__17k5C",ResultsList:"ResultPage_ResultsList__1z_W1",ListHidden:"ResultPage_ListHidden__3JcLI",RightRail:"ResultPage_RightRail__3S8Y9",ResultsMap:"ResultPage_ResultsMap__1TkHS"}},710:function(e,t,a){"use strict";a.r(t);var n=a(68),r=a(69),o=a(71),i=a(70),c=a(72),l=a(0),s=a.n(l),u=a(13),d=a(28),h=a(74),m=a(66);function p(){var e=u.debounce.apply(void 0,arguments);return function(t){return t.persist(),e(t)}}function f(e){return e&&e.length>0?{lat:Object(u.meanBy)(e,(function(e){return e.lat})),lng:Object(u.meanBy)(e,(function(e){return e.lng}))}:null}function g(e){for(var t={},a=("?"===e[0]?e.substr(1):e).split("&"),n=0;n<a.length;n+=1){var r=a[n].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]||"")}return t}var v=a(668),C=a.n(v),_=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(i.a)(t).call(this,e))).searchInput=void 0,a.handleSearch=function(e){var t=e.target.value.trim();a.props.handleUpdateSearchQs(t),a.props.searchClass(t)},a.searchInput=s.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:C.a.SearchInput},s.a.createElement("input",{autoFocus:!0,type:"search",onChange:p(this.handleSearch,1e3),ref:this.searchInput,placeholder:"\u641c\u7d22"}))}}]),t}(l.PureComponent),b=a(669),w=a.n(b),R=function(e){function t(){return Object(n.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.searchClass,a=e.handleUpdateSearchQs;return s.a.createElement("div",{className:w.a.Container},s.a.createElement("div",null,s.a.createElement(_,{searchClass:t,handleUpdateSearchQs:a})))}}]),t}(l.PureComponent),E=a(704),y=a(711),S=function(e){var t=e.checked,a=e.handleOnChange,n=void 0===a?function(){}:a;return s.a.createElement(E.a,{control:s.a.createElement(y.a,{checked:t,onChange:n,color:"secondary"}),label:"\u663e\u793a\u5217\u8868"})},O=a(73),k=a(670),L=a.n(k),j=function(e){return s.a.createElement("div",{className:L.a.Container},e.isFetching?s.a.createElement("div",null,"\u6b63\u5728\u641c\u7d22",e.searchString&&"\u5173\u4e8e".concat(e.searchString,"\u7684\u6587\u7ae0")):s.a.createElement("div",null,s.a.createElement("span",{style:{color:"brown",fontFamily:O.a.typography.english}},e.num||0)," \u6761",e.searchString&&"\u5173\u4e8e".concat(e.searchString,"\u7684"),"\u641c\u7d22\u7ed3\u679c"),!window.isMobile&&s.a.createElement("div",{className:L.a.Toggle},s.a.createElement(S,{checked:e.listView,handleOnChange:e.handleListViewToggle})))},M=a(652),z=a(632),I=a.n(z),T=a(712),N=a(656),x=a(671),B=a.n(x),P=a(705),A=a(706),D=a(91),U=a(65),W=a.n(U);function F(){return(F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Z(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var H=s.a.createElement("path",{d:"M7.0966 7.0966C7.0966 11.0159 7.0966 14.1932 7.0966 14.1932C3.17726 14.1932 0 11.0159 0 7.0966C0 3.17726 3.17726 0 7.0966 0C7.0966 0 7.0966 3.17726 7.0966 7.0966Z",fill:"#DCDCDC"}),Q=s.a.createElement("path",{d:"M7.09578 7.09676C7.09578 3.17741 7.09578 0.00015831 7.09578 0.00015831C11.0151 0.00015831 14.1924 3.17741 14.1924 7.09676C14.1924 11.0161 11.0151 14.1934 7.09578 14.1934C7.09578 14.1934 7.09578 11.0161 7.09578 7.09676Z",fill:"#DCDCDC"}),V=s.a.createElement("path",{d:"M4.7324 10.8052C4.41192 10.9654 4.03736 10.7066 4.09856 10.3671L4.55012 7.86278L2.63728 6.08919C2.37801 5.84879 2.52108 5.42995 2.87938 5.38043L5.52287 5.01505L6.70507 2.73651C6.86531 2.42767 7.32829 2.42767 7.48853 2.73651L8.67073 5.01505L11.3142 5.38043C11.6725 5.42995 11.8156 5.84879 11.5563 6.08919L9.64348 7.86278L10.095 10.3671C10.1562 10.7066 9.78168 10.9654 9.46121 10.8052L7.0968 9.62278L4.7324 10.8052Z",fill:"white"}),G=function(e){var t=e.svgRef,a=e.title,n=Z(e,["svgRef","title"]);return s.a.createElement("svg",F({width:15,height:15,viewBox:"0 0 15 15",fill:"none",ref:t},n),a?s.a.createElement("title",null,a):null,H,Q,V)},q=s.a.forwardRef((function(e,t){return s.a.createElement(G,F({svgRef:t},e))}));a.p;function J(){return(J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function X(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var K=s.a.createElement("path",{d:"M7.0966 7.0966C7.0966 11.0159 7.0966 14.1932 7.0966 14.1932C3.17726 14.1932 0 11.0159 0 7.0966C0 3.17726 3.17726 0 7.0966 0C7.0966 0 7.0966 3.17726 7.0966 7.0966Z",fill:"#50B3DE"}),Y=s.a.createElement("path",{d:"M7.09578 7.09676C7.09578 3.17741 7.09578 0.00015831 7.09578 0.00015831C11.0151 0.00015831 14.1924 3.17741 14.1924 7.09676C14.1924 11.0161 11.0151 14.1934 7.09578 14.1934C7.09578 14.1934 7.09578 11.0161 7.09578 7.09676Z",fill:"#DCDCDC"}),$=s.a.createElement("path",{d:"M4.7324 10.8052C4.41192 10.9654 4.03736 10.7066 4.09856 10.3671L4.55012 7.86278L2.63728 6.08919C2.37801 5.84879 2.52108 5.42995 2.87938 5.38043L5.52287 5.01505L6.70507 2.73651C6.86531 2.42767 7.32829 2.42767 7.48853 2.73651L8.67073 5.01505L11.3142 5.38043C11.6725 5.42995 11.8156 5.84879 11.5563 6.08919L9.64348 7.86278L10.095 10.3671C10.1562 10.7066 9.78168 10.9654 9.46121 10.8052L7.0968 9.62278L4.7324 10.8052Z",fill:"white"}),ee=function(e){var t=e.svgRef,a=e.title,n=X(e,["svgRef","title"]);return s.a.createElement("svg",J({width:15,height:15,viewBox:"0 0 15 15",fill:"none",ref:t},n),a?s.a.createElement("title",null,a):null,K,Y,$)},te=s.a.forwardRef((function(e,t){return s.a.createElement(ee,J({svgRef:t},e))}));a.p;function ae(){return(ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ne(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var re=s.a.createElement("circle",{cx:7.0966,cy:7.0966,r:7.0966,fill:"#50B3DE"}),oe=s.a.createElement("path",{d:"M4.7324 10.8052C4.41192 10.9654 4.03736 10.7066 4.09856 10.3671L4.55012 7.86278L2.63728 6.08919C2.37801 5.84879 2.52108 5.42995 2.87938 5.38043L5.52287 5.01505L6.70507 2.73651C6.86531 2.42767 7.32829 2.42767 7.48853 2.73651L8.67073 5.01505L11.3142 5.38043C11.6725 5.42995 11.8156 5.84879 11.5563 6.08919L9.64348 7.86278L10.095 10.3671C10.1562 10.7066 9.78168 10.9654 9.46121 10.8052L7.0968 9.62278L4.7324 10.8052Z",fill:"white"}),ie=function(e){var t=e.svgRef,a=e.title,n=ne(e,["svgRef","title"]);return s.a.createElement("svg",ae({width:15,height:15,viewBox:"0 0 15 15",fill:"none",ref:t},n),a?s.a.createElement("title",null,a):null,re,oe)},ce=s.a.forwardRef((function(e,t){return s.a.createElement(ie,ae({svgRef:t},e))})),le=(a.p,a(675)),se=a.n(le),ue=function(e){var t=e.score,a=e.showNumerOfReviews,n=void 0===a||a,r=e.showScore,o=void 0!==r&&r,i=e.numOfReviews,c=Math.floor(t),l=Math.ceil(t-c),u=5-c-l,d=Object(M.a)(new Array(c)).map((function(e,t){return s.a.createElement(ce,{key:t})})),h=[];return u>0&&(h=Object(M.a)(new Array(u)).map((function(e,t){return s.a.createElement(q,{key:t})}))),s.a.createElement("div",{className:se.a.Container},d,l>0&&s.a.createElement(te,null),h,o&&s.a.createElement("span",{className:se.a.Score},t.toFixed(1)),n&&s.a.createElement(D.a,{classes:{root:se.a.Number},color:"textSecondary",component:"span"},i," Reviews"))},de=a(676),he=a.n(de),me={trendy_music:"rgba(253, 228, 30, .35)",performance:"rgba(5, 232, 255, .30)",attitude:"rgba(238, 0, 32, .20)",advanced:"rgba(124, 185, 20, .30)",famine:"rgba(253, 228, 35, .30)",powerful:"rgba(254, 87, 0, .25)",tone:"rgba(124, 185, 20, .30)",heels:"rgba(144, 19, 254, .20)"},pe=function(e){var t=e.extraCssClass,a=e.text,n=e.order,r=e.callBackFunc,o=Object.values(me);return s.a.createElement("div",{role:"button",onClick:function(e){e.preventDefault(),e.stopPropagation(),r&&r()},className:"".concat(he.a.Tag," ").concat(t),style:{backgroundColor:o[n?n%o.length:Math.floor(Math.random()*o.length)]}},a)};function fe(){return(fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ge(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var ve=s.a.createElement("path",{d:"M9.6 4.42105C9.6 6.86273 4.8 12 4.8 12C4.8 12 0 6.86273 0 4.42105C0 1.97937 2.14903 0 4.8 0C7.45097 0 9.6 1.97937 9.6 4.42105Z",fill:"#DCDCDC"}),Ce=s.a.createElement("ellipse",{cx:4.79998,cy:4.42106,rx:1.2,ry:1.26316,fill:"white"}),_e=function(e){var t=e.svgRef,a=e.title,n=ge(e,["svgRef","title"]);return s.a.createElement("svg",fe({width:10,height:12,viewBox:"0 0 10 12",fill:"none",ref:t},n),a?s.a.createElement("title",null,a):null,ve,Ce)},be=s.a.forwardRef((function(e,t){return s.a.createElement(_e,fe({svgRef:t},e))})),we=(a.p,a(677)),Re=a.n(we),Ee=function(e){var t=e.text;return s.a.createElement("div",{className:Re.a.Container},s.a.createElement(be,null),s.a.createElement("span",{className:Re.a.Text,style:{fontFamily:O.a.typography.english,color:O.a.palette.text.secondary}},t))},ye=a(170),Se=a(678),Oe=a.n(Se),ke=Object(ye.a)((function(e){return{container:{backgroundColor:e.palette.primary.main}}})),Le=function(e){var t=e.order,a=ke();return s.a.createElement("div",{className:"".concat(Oe.a.Container," ").concat(a.container)},s.a.createElement("div",{className:Oe.a.Order},t))},je=a(679),Me=a.n(je),ze=function(e){var t=e.data,a=Object(N.a)(e,["data"]),n=t.tag&&t.tag.split(/\s*,|\s*\uff0c/);return s.a.createElement(P.a,{className:Me.a.CardRoot},s.a.createElement("a",{href:t.url,className:W.a.Link,target:"__blank",rel:"noopener noreferrer"},s.a.createElement("div",{className:Me.a.CardActionArea,onClick:function(){I.a.publish("results.events.marker.active",{id:t.id,active:!0,lat:t.lat,lng:t.lng}),a.clickToUrl&&a.clickToUrl(t.url)},onMouseEnter:function(){I.a.publish("results.events.marker.active",{id:t.id,active:!0,lat:t.lat,lng:t.lng})},onMouseLeave:function(){I.a.publish("results.events.marker.active",{id:t.id,active:!1})}},s.a.createElement("div",null,s.a.createElement(A.a,{component:"img",alt:t.city||"\u4e00\u8fb9\u5199\u8bd7\u4e00\u8fb9\u65c5\u884c",width:"240",height:"180",image:t.imageUrl||"https://www.parentingforbrain.com/wp-content/uploads/good-parenting-tips.webp",title:t.title,classes:{media:Me.a.Media}})),s.a.createElement("div",{className:Me.a.CardContent},s.a.createElement("div",{className:Me.a.ContentLeft},s.a.createElement("div",null,s.a.createElement(D.a,{variant:"h6",component:"h2",classes:{root:Me.a.Title},style:{color:O.a.palette.purple}},t.title),s.a.createElement("div",{className:Me.a.Info},s.a.createElement(D.a,{variant:"subtitle2",component:"div",classes:{root:Me.a.Author}},s.a.createElement("span",{style:{fontFamily:O.a.typography.english}},"By")," ",t.author),s.a.createElement(Ee,{text:"".concat(t.city," ").concat(t.countryCode)}),s.a.createElement("div",{style:{marginLeft:6}},s.a.createElement(ue,{score:t.score||0,showScore:a.showScore,showNumerOfReviews:!1}))),s.a.createElement("div",{className:Me.a.Intro},s.a.createElement(B.a,{clamp:3},t.introduction))),s.a.createElement("div",{className:Me.a.ContentLeftBottom},s.a.createElement("div",{className:Me.a.CardActions},n&&n.map((function(e,t){return s.a.createElement(pe,{key:t,size:"small",text:e.trim(),callBackFunc:function(){return a.clickToSearch(e)},order:t})}))))),s.a.createElement("div",{className:Me.a.ContentRight},s.a.createElement(Le,{order:a.order}),s.a.createElement("div",{className:Me.a.ContentRightBottom},s.a.createElement(D.a,{classes:{root:Me.a.Written},variant:"subtitle1",color:"textSecondary",component:"div"},"\u53d1\u8868\u4e8e"),s.a.createElement(D.a,{classes:{root:Me.a.Time},variant:"subtitle1",color:"textSecondary",component:"div"},t.written_date)))))))},Ie=a(680),Te=a.n(Ie),Ne=function(e){var t=e.results,a=e.searchClass,n=t&&t.reduce((function(e,t){return e[t.id]=s.a.createRef(),e}),{});return Object(l.useEffect)((function(){var e=I.a.subscribe("results.events.card.active",(function(e,t){var a=t.id;n[a].current&&window.scrollTo({top:n[a].current.offsetTop-n[a].current.clientHeight,left:0,behavior:"smooth"})}));return function(){I.a.unsubscribe(e)}})),s.a.createElement("div",{className:Te.a.Container},t?t.map((function(e,t){return s.a.createElement("div",{key:t,ref:n[e.id]},s.a.createElement(ze,{data:e,order:t+1,showScore:!1,clickToSearch:a}))})):Object(M.a)(new Array(20)).map((function(e,t){return s.a.createElement("div",{key:t,className:Te.a.Skeletons},s.a.createElement(T.a,{variant:"rect",className:Te.a.Skeleton}))})))},xe=a(116),Be=a(653),Pe=a(655),Ae=a(681),De=a.n(Ae),Ue=function(e){var t=e.data,a=e.searchClass,n=e.small,r=void 0!==n&&n,o=t.imageUrl,i=t.author,c=t.title,l=t.score,u=t.written_date,d=t.url,h=t.tag,m=h&&h.split(/\s*,|\s*\uff0c/);return s.a.createElement("div",{className:De.a.Container},s.a.createElement("a",{href:d,className:W.a.Link,target:"__blank",rel:"noopener noreferrer"},s.a.createElement("img",{src:o,width:r?"160":"200"}),s.a.createElement("div",{className:De.a.TitleRow},s.a.createElement(D.a,{classes:{root:De.a.Title},style:{color:O.a.palette.purple},variant:"h6",component:"span"},c)),s.a.createElement("div",{className:De.a.AuthorRow},s.a.createElement("div",{className:De.a.Author},i),s.a.createElement(ue,{score:l||0,showScore:!1,showNumerOfReviews:!1}))),s.a.createElement("div",{className:De.a.TagRow},m&&m.map((function(e,t){return s.a.createElement(pe,{key:t,size:"small",text:e.trim(),extraCssClass:De.a.TagDiv,callBackFunc:function(){return a(e)},order:t})}))),s.a.createElement("div",{className:"".concat(De.a.FlexRow," ").concat(De.a.BottomRow)},s.a.createElement("div",null,s.a.createElement("span",{className:De.a.Publish,style:{color:O.a.palette.text.secondary}},"\u4e00\u8fb9\u5199\u8bd7\u4e00\u8fb9\u65c5\u884c")),s.a.createElement(D.a,{classes:{root:De.a.Time},style:{fontFamily:O.a.typography.english},variant:"subtitle2",color:"textSecondary",component:"div"},u)))},We=function(e){var t=e.id,a=e.labelText,n=e.order,r=e.mapWidth,o=e.data,i=e.zoom,c=e.searchClass,u=Object(l.useState)(!1),d=Object(Be.a)(u,2),h=d[0],m=d[1],p=o.lat,f=o.lng,g=Object(l.useRef)(null);Object(l.useEffect)((function(){function e(e,a){m(!1),a.id===t&&m(a.active)}var a=I.a.subscribe("results.events.marker.active",e),n=I.a.subscribe("results.events.card.active",e);return function(){I.a.unsubscribe(a),I.a.unsubscribe(n)}}),[t,r]);var v={path:"M12.0409 26.0404C12.0093 25.9789 11.9773 25.9172 11.9449 25.8553C11.6776 25.345 11.3698 24.7998 11.0642 24.3602C10.9126 24.1421 10.7429 23.9228 10.5615 23.7411C10.4095 23.5888 10.1231 23.331 9.7271 23.2461C4.75554 22.179 1 17.6686 1 12.2431C1 6.01469 5.94368 1 12 1C18.0563 1 23 6.01469 23 12.2431C23 17.5189 19.2825 22.0423 14.4895 23.2543C14.1303 23.3451 13.8513 23.5664 13.6738 23.7297C13.4768 23.9109 13.2906 24.1292 13.1219 24.3497C12.7832 24.7922 12.4452 25.3359 12.1528 25.8438C12.1149 25.9096 12.0776 25.9752 12.0409 26.0404Z",fillOpacity:1,fillColor:h?"#6b6ec8":"#fff",strokeColor:"#6b6ec8",labelOrigin:new google.maps.Point(12.1,12.5)},C=!1,_=new google.maps.Size(11,-3);return!i||i>=8?(v.scale=1,v.strokeWeight=2,C=!0):7===i?(v.scale=.5,v.strokeWeight=1,_=new google.maps.Size(6,-3)):(v.scale=.25,v.strokeWeight=1,v.fillColor=h?"#6b6ec8":"brown",v.strokeColor=h?"#6b6ec8":"brown",_=new google.maps.Size(2,-3)),s.a.createElement("div",{ref:g},s.a.createElement(Pe.c,{position:{lat:p,lng:f},icon:v,label:C?{text:a,fontWeight:"bold",fontSize:"13px",fontFamily:O.a.typography.english,color:h?"#fff":"inherit"}:void 0,zIndex:h?99:n,onClick:function(){m(!0),I.a.publish("results.events.card.active",{id:t,active:!0})}},h&&s.a.createElement(Pe.b,{options:{pixelOffset:_},position:{lat:p,lng:f}},s.a.createElement(Ue,{data:o,searchClass:c,small:!!window.isMobile}))))},Fe=function(e){var t={mapTypeControl:!window.isMobile,gestureHandling:window.isMobile?"greedy":void 0,mapTypeControlOptions:{position:6},streetViewControl:!1,fullscreenControl:!1};return s.a.createElement(Pe.a,{onLoad:function(t){e.setMapRef(t)},options:t,mapContainerStyle:{width:"100%",height:"100%"},zoom:e.zoom||8,center:e.center,onZoomChanged:e.onZoomChanged,onBoundsChanged:Object(u.debounce)(e.onBoundsChanged,1e3)},e.children)},Ze=a(682),He=a.n(Ze),Qe=function(){return s.a.createElement("div",{className:He.a.Container},s.a.createElement("div",{className:He.a.Dot}),s.a.createElement("div",{className:He.a.Dot}),s.a.createElement("div",{className:He.a.Dot}))},Ve=a(683),Ge=a.n(Ve),qe=function(e){var t=e.callBackFunc,a=e.isFetching;return s.a.createElement("div",{className:"".concat(Ge.a.Container," ").concat(window.isMobile||!window.google?Ge.a.Pos2:Ge.a.Pos1),role:"button",onClick:function(e){e.preventDefault(),e.stopPropagation(),t&&t()}},a?s.a.createElement(Qe,null):"\u641c\u7d22\u8fd9\u7247\u533a\u57df")},Je=a(684),Xe=a.n(Je),Ke=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(o.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).tokenPanTo=void 0,a.mapRef=void 0,a.state={zoom:9,center:{lat:35.676,lng:139.65}},a.handleMapPanToMarker=function(e,t){t.lat&&a.mapRef&&a.mapRef.panTo({lat:t.lat,lng:t.lng})},a.handleMapReCenter=function(e){a.setState({center:e,zoom:a.zoomBasedOnResults()},(function(){var e=a.state.zoom;a.mapRef&&a.mapRef.setZoom(e||8)}))},a.zoomBasedOnResults=function(){var e=localStorage.getItem("zoomLevelBeforeSearch");if(e&&"number"===typeof+e)return+e;var t=a.props.results;return t?t.length>=25?5:t.length>9?6:7:void 0},a.handleZoomChanged=function(){var e=Object(xe.a)(a).mapRef;e&&a.setState({zoom:e.getZoom(),center:e.getCenter()})},a.handleClickBoundsSearch=function(){a.props.searchClassInMap(a.mapRef.getBounds()),localStorage.setItem("zoomLevelBeforeSearch","".concat(a.mapRef.getZoom())),localStorage.setItem("centerBeforeSearch","".concat(a.mapRef.getCenter()))},a.handleBoundsChanged=function(){},a.setMapRef=function(e){a.mapRef=e},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.tokenPanTo=PubSub.subscribe("results.events.marker.active",this.handleMapPanToMarker)}},{key:"componentDidUpdate",value:function(e){if(e.results!==this.props.results){var t=localStorage.getItem("centerBeforeSearch");t?this.handleMapReCenter(t):this.handleMapReCenter(f(this.props.results))}}},{key:"componentWillUnmount",value:function(){PubSub.unsubscribe(this.tokenPanTo)}},{key:"render",value:function(){var e=this.props,t=e.results,a=e.mapWidth,n=e.isFetching,r=e.searchClass,o=this.state,i=o.zoom,c=o.center;return window.google?s.a.createElement(Fe,{center:c,onZoomChanged:this.handleZoomChanged,onBoundsChanged:this.handleBoundsChanged,setMapRef:this.setMapRef},t&&t.map((function(e,t){return s.a.createElement("div",{key:t},s.a.createElement("div",null,e.id),s.a.createElement(We,{zoom:i,id:e.id,data:e,labelText:"".concat(t+1),order:t,mapWidth:a,searchClass:r}))})),this.mapRef&&s.a.createElement(qe,{isFetching:n,callBackFunc:this.handleClickBoundsSearch})):s.a.createElement("div",{className:Xe.a.GoogleUnavailable},s.a.createElement("h2",{className:Xe.a.Can},"\u60e8\u3002\u8c37\u6b4c\u5730\u56fe\u4e0d\u53ef\u7528\u3002"),s.a.createElement("div",null,"Google Maps is not available in your region."),s.a.createElement("h3",null,"\u8bd5\u8bd5\u641c\u7d22\u6587\u7ae0\u5427\uff5e"))}}]),t}(l.PureComponent),Ye=a(707),$e=a(708),et=(a(709),a(628)),tt=a.n(et),at=a(685),nt=a.n(at),rt=new tt.a.Icon({iconUrl:a(633),iconRetinaUrl:a(633),iconAnchor:void 0,popupAnchor:[0,-5],shadowUrl:void 0,shadowSize:void 0,shadowAnchor:void 0,iconSize:new tt.a.Point(24,24),className:nt.a.Icon}),ot=new tt.a.Icon({iconUrl:a(634),iconRetinaUrl:a(634),iconAnchor:void 0,popupAnchor:[0,-5],shadowUrl:void 0,shadowSize:void 0,shadowAnchor:void 0,iconSize:new tt.a.Point(24,24),className:nt.a.IconActive}),it=new tt.a.Icon({iconUrl:a(633),iconRetinaUrl:a(633),iconAnchor:void 0,popupAnchor:[0,-5],shadowUrl:void 0,shadowSize:void 0,shadowAnchor:void 0,iconSize:new tt.a.Point(15,15),className:nt.a.Icon}),ct=new tt.a.Icon({iconUrl:a(634),iconRetinaUrl:a(634),iconAnchor:void 0,popupAnchor:[0,-5],shadowUrl:void 0,shadowSize:void 0,shadowAnchor:void 0,iconSize:new tt.a.Point(15,15),className:nt.a.IconActive}),lt=new tt.a.Icon({iconUrl:a(644),iconRetinaUrl:a(644),iconAnchor:void 0,popupAnchor:[0,-5],shadowUrl:void 0,shadowSize:void 0,shadowAnchor:void 0,iconSize:new tt.a.Point(6,6),className:nt.a.Icon}),st=new tt.a.Icon({iconUrl:a(645),iconRetinaUrl:a(645),iconAnchor:void 0,popupAnchor:[0,-5],shadowUrl:void 0,shadowSize:void 0,shadowAnchor:void 0,iconSize:new tt.a.Point(6,6),className:nt.a.IconActive}),ut=(a(686),s.a.forwardRef((function(e,t){var a=Object(l.useState)(!1),n=Object(Be.a)(a,2),r=n[0],o=n[1],i=e.id,c=(e.labelText,e.order),u=e.mapWidth,d=e.data,h=e.zoom,m=e.searchClass,p=d.lat,f=d.lng;Object(l.useEffect)((function(){function e(e,t){o(!1),t.id===i&&o(t.active)}var t=I.a.subscribe("results.events.marker.active",e),a=I.a.subscribe("results.events.card.active",e);return function(){I.a.unsubscribe(t),I.a.unsubscribe(a)}}),[i,u]);var g=rt;return g=!h||h>=8?r?ot:rt:7===h?r?ct:it:r?st:lt,s.a.createElement(Ye.a,{position:[p,f],icon:g,style:{zIndex:r?99:c},ref:function(e){return t(e,d.id)},onclick:function(){o(!0),I.a.publish("results.events.card.active",{id:i,active:!0})}},s.a.createElement($e.a,{position:[p,f]},s.a.createElement(Ue,{data:d,searchClass:m,small:!!window.isMobile})),!1)}))),dt=a(713),ht=a(714);delete tt.a.Icon.Default.prototype._getIconUrl,tt.a.Icon.Default.mergeOptions({iconRetinaUrl:a(687),iconUrl:a(688),shadowUrl:a(689)});var mt=function(e){var t=e.center,a=e.zoom,n=void 0===a?8:a,r=Object(N.a)(e,["center","zoom"]),o=[t.lat,t.lng];return s.a.createElement(dt.a,{onzoomend:r.onZoomEnd,dragging:!0,ref:r.setMapRef,center:o,zoom:n},s.a.createElement(ht.a,{url:"https://www.google.cn/maps/vt?lyrs=m@189&gl=cn&x={x}&y={y}&z={z}",attribution:"Map data \xa9 Google | Made with \u2665 in 2020"}),r.children)},pt=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(o.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).tokenPanTo=void 0,a.mapRef=void 0,a.resizeTimeout=void 0,a.markerRefs={},a.state={zoom:9,center:{lat:35.676,lng:139.65}},a.handleMapPanToMarker=function(e,t){t.lat&&(a.mapRef&&a.mapRef.leafletElement.panTo([t.lat,t.lng]),a.markerRefs[t.id]&&a.markerRefs[t.id].leafletElement.openPopup())},a.handleMapReCenter=function(e){a.setState({center:e,zoom:a.zoomBasedOnResults()})},a.zoomBasedOnResults=function(){var e=a.props.firstLoad,t=localStorage.getItem("zoomLevelBeforeSearch");if(t&&"number"===typeof+t)return+t;var n=a.props.results;return e?8:n?n.length>=25?5:n.length>9?6:7:void 0},a.handleZoomChanged=function(){var e=Object(xe.a)(a).mapRef;if(e){var t=e.leafletElement.getCenter();a.setState({zoom:e.leafletElement.getZoom(),center:{lat:t.lat,lng:t.lng}})}},a.handleClickBoundsSearch=function(){a.props.searchClassInMap(a.mapRef.leafletElement.getBounds());var e=a.mapRef.leafletElement.getCenter();localStorage.setItem("zoomLevelBeforeSearch","".concat(a.mapRef.leafletElement.getZoom())),localStorage.setItem("centerBeforeSearch","".concat(JSON.stringify(e)))},a.handleBoundsChanged=function(){},a.setMapRef=function(e){a.mapRef=e},a.setMarkerRef=function(e,t){a.markerRefs[t]=e},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.tokenPanTo=PubSub.subscribe("results.events.marker.active",this.handleMapPanToMarker),this.resizeTimeout=setTimeout((function(){return window.dispatchEvent(new Event("resize"))}))}},{key:"componentDidUpdate",value:function(e){if(e.results!==this.props.results){var t=localStorage.getItem("centerBeforeSearch");t?this.handleMapReCenter(JSON.parse(t)):this.handleMapReCenter(f(this.props.results))}}},{key:"componentWillUnmount",value:function(){clearTimeout(this.resizeTimeout),PubSub.unsubscribe(this.tokenPanTo)}},{key:"render",value:function(){var e=this,t=this.props,a=t.results,n=t.mapWidth,r=t.isFetching,o=t.searchClass,i=this.state,c=i.zoom,l=i.center;return s.a.createElement(mt,{zoom:c,setMapRef:this.setMapRef,center:l||{lat:35.676,lng:139.65},onZoomEnd:this.handleZoomChanged},a&&a.map((function(t,a){return s.a.createElement("div",{key:a},s.a.createElement(ut,{zoom:c,id:t.id,data:t,labelText:"".concat(a+1),order:a,mapWidth:n,searchClass:o,ref:e.setMarkerRef}))})),this.mapRef&&s.a.createElement(qe,{isFetching:r,callBackFunc:this.handleClickBoundsSearch}))}}]),t}(l.PureComponent),ft=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(i.a)(t).call(this,e))).state={hasError:!1},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidCatch",value:function(e,t){}},{key:"render",value:function(){return this.state.hasError?s.a.createElement("h1",null,this.props.errorMessage||"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(s.a.Component),gt=a(119),vt=a(100),Ct=a.n(vt),_t=a(87);function bt(){return{type:_t.b,fetching:!0}}function wt(e){return{type:_t.c,fetching:!1,postsData:e}}function Rt(e){return{type:_t.a,fetching:!1,errorMessage:e}}var Et=function(e){return function(t){return t(bt()),Ct.a.get("https://2vpgvmhzzi.execute-api.ap-northeast-1.amazonaws.com/dev/posts",{params:{search:e}}).then((function(e){t(wt(e.data.body))})).catch((function(e){t(Rt(String(e)))}))}},yt=function(e){return function(t){var a;return window.google&&e instanceof google.maps.LatLngBounds?a={search_by_map:!0,ne_lat:e.getNorthEast().lat(),ne_lng:e.getNorthEast().lng(),sw_lat:e.getSouthWest().lat(),sw_lng:e.getSouthWest().lng()}:e instanceof tt.a.LatLngBounds&&(a={search_by_map:!0,ne_lat:e.getNorthEast().lat,ne_lng:e.getNorthEast().lng,sw_lat:e.getSouthWest().lat,sw_lng:e.getSouthWest().lng}),t(bt()),Ct.a.get("https://2vpgvmhzzi.execute-api.ap-northeast-1.amazonaws.com/dev/posts",{params:a}).then((function(e){t(wt(e.data.body))})).catch((function(e){t(Rt(String(e)))}))}},St=a(690),Ot=a.n(St),kt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(i.a)(t).call(this,e))).rightRailRef=void 0,a.state={rightRailWidth:"100%",searchString:g(a.props.location.search).q||"\u4e1c\u4eac",listView:!0,firstLoad:!0},a.updateMapContainerSize=function(){a.rightRailRef.current&&a.setState({rightRailWidth:a.rightRailRef.current.offsetWidth})},a.handleUpdateSearchQs=function(e){a.props.history.push({search:e.length>0?"?q=".concat(e):""})},a.handleListViewToggle=function(){a.setState((function(e){return{listView:!e.listView}}),a.updateMapContainerSize)},a.searchClass=function(e){a.props.dispatch(Et(e)),a.setState({searchString:e,firstLoad:!1}),a.handleUpdateSearchQs(e),a.clearStoredCenterAndZoom(),Object(m.b)({category:"ResultPage",label:"".concat(e),action:"search"})},a.clearStoredCenterAndZoom=function(){localStorage.removeItem("zoomLevelBeforeSearch"),localStorage.removeItem("centerBeforeSearch")},a.searchClassInMap=function(e){a.props.dispatch(yt(e)),a.setState({searchString:"",firstLoad:!1}),Object(m.b)({category:"ResultPage",label:"map interaction",action:"search"})},a.debouncedUpdateMapContainerSize=Object(u.debounce)(a.updateMapContainerSize,500),a.rightRailRef=s.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.debouncedUpdateMapContainerSize),this.updateMapContainerSize();var e=g(this.props.location.search);"string"===typeof e.q?this.props.dispatch(Et(e.q)):this.props.posts||this.props.dispatch(function(e){return function(t,a){if(function(e){var t=e.posts?e.posts.postsData:null;return!(t&&t.fetching)}(a()))return t(Et(e))}}("\u4e1c\u4eac")),this.clearStoredCenterAndZoom()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.debouncedUpdateMapContainerSize)}},{key:"render",value:function(){var e=this.state,t=e.rightRailWidth,a=e.searchString,n=e.listView,r=e.firstLoad,o=this.props,i=o.posts,c=o.isFetching,l=s.a.createElement(pt,{results:i,mapWidth:t,searchClass:this.searchClass,searchClassInMap:this.searchClassInMap,isFetching:c,firstLoad:r});return window.google&&(l=s.a.createElement(Ke,{results:i,mapWidth:t,searchClass:this.searchClass,searchClassInMap:this.searchClassInMap,isFetching:c})),s.a.createElement("div",{className:Ot.a.Container},s.a.createElement("div",{className:Ot.a.SearchBar},s.a.createElement("div",{className:Ot.a.Bar},s.a.createElement(R,{searchClass:this.searchClass,handleUpdateSearchQs:this.handleUpdateSearchQs})),s.a.createElement("div",{className:Ot.a.Bar},s.a.createElement(j,{listView:n,searchString:a,num:i&&i.length,isFetching:c,handleListViewToggle:this.handleListViewToggle}))),s.a.createElement("div",{className:"".concat(Ot.a.Results," ").concat(n?Ot.a.ResultsWrap:"")},!window.isMobile&&s.a.createElement("div",{className:"".concat(Ot.a.ResultsList," ").concat(n?"":Ot.a.ListHidden)},s.a.createElement(Ne,{results:i,searchClass:this.searchClass})),s.a.createElement("div",{ref:this.rightRailRef,className:Ot.a.RightRail},s.a.createElement("div",{style:{width:t},className:Ot.a.ResultsMap},s.a.createElement(ft,{errorMessage:"\u6709\u70b9\u95ee\u9898"},l)))))}}]),t}(l.Component);t.default=Object(h.b)((function(e){var t=e.posts;return{posts:t.postsData,isFetching:t.fetching}}),(function(e){return{dispatch:e}}))(Object(d.g)(Object(gt.a)(kt)))}}]);
//# sourceMappingURL=4.d97c7d4a.chunk.js.map