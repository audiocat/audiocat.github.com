(this.webpackJsonppoemandtravel=this.webpackJsonppoemandtravel||[]).push([[5],{664:function(e,t,a){e.exports=a.p+"static/media/markerleaflet.e99403c6.svg"},665:function(e,t,a){e.exports=a.p+"static/media/markerleaflet-active.1041e311.svg"},714:function(e,t,a){e.exports=a.p+"static/media/markerleaflet-small.56ec8aeb.svg"},715:function(e,t,a){e.exports=a.p+"static/media/markerleaflet-active-small.ce87de22.svg"},738:function(e,t,a){e.exports={SearchInput:"SearchForm_SearchInput__AEH8N"}},739:function(e,t,a){e.exports={Container:"ResultPageTopBar_Container__OosJD",Category:"ResultPageTopBar_Category__2WsM6"}},740:function(e,t,a){e.exports={Container:"ResultPageInfoBar_Container__S4VP0",Toggle:"ResultPageInfoBar_Toggle__2XYqS"}},808:function(e,t,a){e.exports={Container:"Review_Container__14Coy",Score:"Review_Score__2hzpT",Number:"Review_Number__dNvCU"}},809:function(e,t,a){e.exports={Tag:"Tag_Tag__2uLIq"}},810:function(e,t,a){e.exports={Container:"Location_Container__ANHFz",Text:"Location_Text__GG1YI"}},811:function(e,t,a){e.exports={Container:"ResultOrder_Container__1_Oht",Order:"ResultOrder_Order__1EbGF"}},812:function(e,t,a){e.exports={CardRoot:"ResultCard_CardRoot__2iteN",CardLink:"ResultCard_CardLink__O3d6F",CardActionArea:"ResultCard_CardActionArea__24wHh",CardContent:"ResultCard_CardContent__1D2cw",CardActions:"ResultCard_CardActions__1z_He",ContentLeft:"ResultCard_ContentLeft__1rdtd",ContentRight:"ResultCard_ContentRight__1DvQF",ContentLeftBottom:"ResultCard_ContentLeftBottom__2C-lW",ContentRightBottom:"ResultCard_ContentRightBottom__3AgMH",Intro:"ResultCard_Intro__35HCd",Media:"ResultCard_Media__3STQs",ShareButton:"ResultCard_ShareButton__1GiX7",Info:"ResultCard_Info__1DKLC",Author:"ResultCard_Author__3qIUX",Title:"ResultCard_Title__13O3l",Written:"ResultCard_Written__1ufpt",Time:"ResultCard_Time__2hR01",TagContainer:"ResultCard_TagContainer__f-yv6"}},813:function(e,t,a){e.exports={Container:"ResultList_Container__10FhH",VList:"ResultList_VList__3o1TM",Skeletons:"ResultList_Skeletons__3u_NP",Skeleton:"ResultList_Skeleton__35xQo",VCard:"ResultList_VCard__3XiUj"}},814:function(e,t,a){e.exports={Container:"InfoWindow_Container__Geaw3",Author:"InfoWindow_Author__2DJgj",TitleRow:"InfoWindow_TitleRow__2tuT1",Title:"InfoWindow_Title__1Owkl",FlexRow:"InfoWindow_FlexRow__qwTNi",AuthorRow:"InfoWindow_AuthorRow__3oFz5",TagRow:"InfoWindow_TagRow__3xZZ1",TagDiv:"InfoWindow_TagDiv__U0nCX",BottomRow:"InfoWindow_BottomRow__FtApo",Date:"InfoWindow_Date__3b0Nt",Price:"InfoWindow_Price__3W0sk",Time:"InfoWindow_Time__2E9bH"}},815:function(e,t,a){e.exports={Container:"LoadingDots_Container__2I4vD",Dot:"LoadingDots_Dot__kb9_R",dots:"LoadingDots_dots__2d_fE"}},816:function(e,t,a){e.exports={Container:"ReSearchBounds_Container__1KAF9",Pos1:"ReSearchBounds_Pos1__3DLUQ",Pos2:"ReSearchBounds_Pos2__12afO"}},817:function(e,t,a){e.exports={GoogleUnavailable:"ResultMap_GoogleUnavailable__3j6WD",Can:"ResultMap_Can__1pKtD"}},818:function(e,t,a){e.exports={Icon:"LeafletMarkerIcon_Icon__zWm3b",IconActive:"LeafletMarkerIcon_IconActive__1Ol-X"}},819:function(e,t,a){e.exports={Tooltip:"ResultMarkerLeaflet_Tooltip__2DCVp"}},823:function(e,t,a){e.exports={Container:"ResultPage_Container__36kb3",Results:"ResultPage_Results__QC6Q0",ResultsWrap:"ResultPage_ResultsWrap__3zUab",SearchBar:"ResultPage_SearchBar__19JPt",Bar:"ResultPage_Bar__17k5C",ResultsList:"ResultPage_ResultsList__1z_W1",ListHidden:"ResultPage_ListHidden__3JcLI",RightRail:"ResultPage_RightRail__3S8Y9",ResultsMap:"ResultPage_ResultsMap__1TkHS"}},844:function(e,t,a){"use strict";a.r(t);var n=a(69),r=a(70),o=a(72),i=a(71),c=a(73),s=a(0),l=a.n(s),u=a(13),d=a(28),h=a(74),m=a(67);function p(){var e=u.debounce.apply(void 0,arguments);return function(t){return t.persist(),e(t)}}function f(e){return e&&e.length>0?{lat:Object(u.meanBy)(e,(function(e){return e.lat})),lng:Object(u.meanBy)(e,(function(e){return e.lng}))}:null}function g(e){for(var t={},a=("?"===e[0]?e.substr(1):e).split("&"),n=0;n<a.length;n+=1){var r=a[n].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]||"")}return t}var v=a(738),C=a.n(v),_=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(i.a)(t).call(this,e))).searchInput=void 0,a.handleSearch=function(e){var t=e.target.value.trim();a.props.handleUpdateSearchQs(t),a.props.searchClass(t)},a.searchInput=l.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:C.a.SearchInput},l.a.createElement("input",{autoFocus:!0,type:"search",onChange:p(this.handleSearch,1e3),ref:this.searchInput,placeholder:"\u641c\u7d22"}))}}]),t}(s.PureComponent),b=a(739),w=a.n(b),R=function(e){function t(){return Object(n.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.searchClass,a=e.handleUpdateSearchQs;return l.a.createElement("div",{className:w.a.Container},l.a.createElement("div",null,l.a.createElement(_,{searchClass:t,handleUpdateSearchQs:a})))}}]),t}(s.PureComponent),E=a(838),y=a(845),S=function(e){var t=e.checked,a=e.handleOnChange,n=void 0===a?function(){}:a;return l.a.createElement(E.a,{control:l.a.createElement(y.a,{checked:t,onChange:n,color:"secondary"}),label:"\u663e\u793a\u5217\u8868"})},O=a(52),k=a(740),L=a.n(k),j=function(e){return l.a.createElement("div",{className:L.a.Container},e.isFetching?l.a.createElement("div",null,"\u6b63\u5728\u641c\u7d22",e.searchString&&"\u5173\u4e8e".concat(e.searchString,"\u7684\u6587\u7ae0")):l.a.createElement("div",null,l.a.createElement("span",{style:{color:"brown",fontFamily:O.a.typography.english}},e.num||0)," \u6761",e.searchString&&"\u5173\u4e8e".concat(e.searchString,"\u7684"),"\u641c\u7d22\u7ed3\u679c"),!window.isMobile&&l.a.createElement("div",{className:L.a.Toggle},l.a.createElement(S,{checked:e.listView,handleOnChange:e.handleListViewToggle})))},M=a(722),z=a(658),I=a.n(z),T=a(846),N=a(824),x=a(726),B=a(804),P=a.n(B),A=a(839),U=a(840),D=a(91),W=a(66),F=a.n(W);function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function V(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var H=l.a.createElement("path",{d:"M7.0966 7.0966C7.0966 11.0159 7.0966 14.1932 7.0966 14.1932C3.17726 14.1932 0 11.0159 0 7.0966C0 3.17726 3.17726 0 7.0966 0C7.0966 0 7.0966 3.17726 7.0966 7.0966Z",fill:"#DCDCDC"}),Q=l.a.createElement("path",{d:"M7.09578 7.09676C7.09578 3.17741 7.09578 0.00015831 7.09578 0.00015831C11.0151 0.00015831 14.1924 3.17741 14.1924 7.09676C14.1924 11.0161 11.0151 14.1934 7.09578 14.1934C7.09578 14.1934 7.09578 11.0161 7.09578 7.09676Z",fill:"#DCDCDC"}),G=l.a.createElement("path",{d:"M4.7324 10.8052C4.41192 10.9654 4.03736 10.7066 4.09856 10.3671L4.55012 7.86278L2.63728 6.08919C2.37801 5.84879 2.52108 5.42995 2.87938 5.38043L5.52287 5.01505L6.70507 2.73651C6.86531 2.42767 7.32829 2.42767 7.48853 2.73651L8.67073 5.01505L11.3142 5.38043C11.6725 5.42995 11.8156 5.84879 11.5563 6.08919L9.64348 7.86278L10.095 10.3671C10.1562 10.7066 9.78168 10.9654 9.46121 10.8052L7.0968 9.62278L4.7324 10.8052Z",fill:"white"}),q=function(e){var t=e.svgRef,a=e.title,n=V(e,["svgRef","title"]);return l.a.createElement("svg",Z({width:15,height:15,viewBox:"0 0 15 15",fill:"none",ref:t},n),a?l.a.createElement("title",null,a):null,H,Q,G)},J=l.a.forwardRef((function(e,t){return l.a.createElement(q,Z({svgRef:t},e))}));a.p;function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function K(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Y=l.a.createElement("path",{d:"M7.0966 7.0966C7.0966 11.0159 7.0966 14.1932 7.0966 14.1932C3.17726 14.1932 0 11.0159 0 7.0966C0 3.17726 3.17726 0 7.0966 0C7.0966 0 7.0966 3.17726 7.0966 7.0966Z",fill:"inherit"}),$=l.a.createElement("path",{d:"M7.09578 7.09676C7.09578 3.17741 7.09578 0.00015831 7.09578 0.00015831C11.0151 0.00015831 14.1924 3.17741 14.1924 7.09676C14.1924 11.0161 11.0151 14.1934 7.09578 14.1934C7.09578 14.1934 7.09578 11.0161 7.09578 7.09676Z",fill:"#DCDCDC"}),ee=l.a.createElement("path",{d:"M4.7324 10.8052C4.41192 10.9654 4.03736 10.7066 4.09856 10.3671L4.55012 7.86278L2.63728 6.08919C2.37801 5.84879 2.52108 5.42995 2.87938 5.38043L5.52287 5.01505L6.70507 2.73651C6.86531 2.42767 7.32829 2.42767 7.48853 2.73651L8.67073 5.01505L11.3142 5.38043C11.6725 5.42995 11.8156 5.84879 11.5563 6.08919L9.64348 7.86278L10.095 10.3671C10.1562 10.7066 9.78168 10.9654 9.46121 10.8052L7.0968 9.62278L4.7324 10.8052Z",fill:"white"}),te=function(e){var t=e.svgRef,a=e.title,n=K(e,["svgRef","title"]);return l.a.createElement("svg",X({width:15,height:15,viewBox:"0 0 15 15",fill:"inherit",ref:t},n),a?l.a.createElement("title",null,a):null,Y,$,ee)},ae=l.a.forwardRef((function(e,t){return l.a.createElement(te,X({svgRef:t},e))}));a.p;function ne(){return(ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function re(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var oe=l.a.createElement("circle",{cx:7.0966,cy:7.0966,r:7.0966,fill:"inherit"}),ie=l.a.createElement("path",{d:"M4.7324 10.8052C4.41192 10.9654 4.03736 10.7066 4.09856 10.3671L4.55012 7.86278L2.63728 6.08919C2.37801 5.84879 2.52108 5.42995 2.87938 5.38043L5.52287 5.01505L6.70507 2.73651C6.86531 2.42767 7.32829 2.42767 7.48853 2.73651L8.67073 5.01505L11.3142 5.38043C11.6725 5.42995 11.8156 5.84879 11.5563 6.08919L9.64348 7.86278L10.095 10.3671C10.1562 10.7066 9.78168 10.9654 9.46121 10.8052L7.0968 9.62278L4.7324 10.8052Z",fill:"white"}),ce=function(e){var t=e.svgRef,a=e.title,n=re(e,["svgRef","title"]);return l.a.createElement("svg",ne({width:15,height:15,viewBox:"0 0 15 15",fill:"inherit",ref:t},n),a?l.a.createElement("title",null,a):null,oe,ie)},se=l.a.forwardRef((function(e,t){return l.a.createElement(ce,ne({svgRef:t},e))})),le=(a.p,a(808)),ue=a.n(le),de=function(e){var t=e.score,a=e.showNumerOfReviews,n=void 0===a||a,r=e.showScore,o=void 0!==r&&r,i=e.numOfReviews,c=O.a.palette.secondary.main,s=Math.floor(t),u=Math.ceil(t-s),d=5-s-u,h=Object(M.a)(new Array(s)).map((function(e,t){return l.a.createElement(se,{key:t,fill:c})})),m=[];return d>0&&(m=Object(M.a)(new Array(d)).map((function(e,t){return l.a.createElement(J,{key:t,fill:c})}))),l.a.createElement("div",{className:ue.a.Container},h,u>0&&l.a.createElement(ae,{fill:c}),m,o&&l.a.createElement("span",{className:ue.a.Score},t.toFixed(1)),n&&l.a.createElement(D.a,{classes:{root:ue.a.Number},color:"textSecondary",component:"span"},i," Reviews"))},he=a(809),me=a.n(he),pe={trendy_music:"rgba(253, 228, 30, .35)",performance:"rgba(5, 232, 255, .30)",attitude:"rgba(238, 0, 32, .20)",advanced:"rgba(124, 185, 20, .30)",famine:"rgba(253, 228, 35, .30)",powerful:"rgba(254, 87, 0, .25)",tone:"rgba(124, 185, 20, .30)",heels:"rgba(144, 19, 254, .20)"},fe=Object(s.memo)((function(e){var t=e.extraCssClass,a=e.text,n=e.order,r=e.callBackFunc,o=Object.values(pe),i=Object(s.useMemo)((function(){return Math.floor(Math.random()*o.length)}),[]);return l.a.createElement("div",{role:"button",onClick:function(e){e.preventDefault(),e.stopPropagation(),r&&r()},className:"".concat(me.a.Tag," ").concat(t),style:{backgroundColor:o[n?n%o.length:i]}},a)}));function ge(){return(ge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ve(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Ce=l.a.createElement("path",{d:"M9.6 4.42105C9.6 6.86273 4.8 12 4.8 12C4.8 12 0 6.86273 0 4.42105C0 1.97937 2.14903 0 4.8 0C7.45097 0 9.6 1.97937 9.6 4.42105Z",fill:"#DCDCDC"}),_e=l.a.createElement("ellipse",{cx:4.79998,cy:4.42106,rx:1.2,ry:1.26316,fill:"white"}),be=function(e){var t=e.svgRef,a=e.title,n=ve(e,["svgRef","title"]);return l.a.createElement("svg",ge({width:10,height:12,viewBox:"0 0 10 12",fill:"none",ref:t},n),a?l.a.createElement("title",null,a):null,Ce,_e)},we=l.a.forwardRef((function(e,t){return l.a.createElement(be,ge({svgRef:t},e))})),Re=(a.p,a(810)),Ee=a.n(Re),ye=function(e){var t=e.text;return l.a.createElement("div",{className:Ee.a.Container},l.a.createElement(we,null),l.a.createElement("span",{className:Ee.a.Text,style:{fontFamily:O.a.typography.english,color:O.a.palette.text.secondary}},t))},Se=a(170),Oe=a(811),ke=a.n(Oe),Le=Object(Se.a)((function(e){return{container:{backgroundColor:e.palette.primary.main}}})),je=function(e){var t=e.order,a=Le();return l.a.createElement("div",{className:"".concat(ke.a.Container," ").concat(a.container)},l.a.createElement("div",{className:ke.a.Order},t))},Me=a(812),ze=a.n(Me),Ie=function(e){var t=e.data,a=Object(x.a)(e,["data"]),n=t.tag&&t.tag.split(/\s*,|\s*\uff0c|\s+/);return l.a.createElement(A.a,{className:ze.a.CardRoot},l.a.createElement("a",{href:t.url,className:F.a.Link,target:"__blank",rel:"noopener noreferrer"},l.a.createElement("div",{className:ze.a.CardActionArea,onClick:function(){I.a.publish("results.events.marker.active",{id:t.id,active:!0,lat:t.lat,lng:t.lng}),a.clickToUrl&&a.clickToUrl(t.url)},onMouseEnter:function(){I.a.publish("results.events.marker.active",{id:t.id,active:!0,lat:t.lat,lng:t.lng})},onMouseLeave:function(){I.a.publish("results.events.marker.active",{id:t.id,active:!1})}},l.a.createElement("div",null,l.a.createElement(U.a,{component:"img",alt:t.city||"\u4e00\u8fb9\u5199\u8bd7\u4e00\u8fb9\u65c5\u884c",width:"240",height:"180",image:t.imageUrl||"https://www.parentingforbrain.com/wp-content/uploads/good-parenting-tips.webp",title:t.title,classes:{media:ze.a.Media}})),l.a.createElement("div",{className:ze.a.CardContent},l.a.createElement("div",{className:ze.a.ContentLeft},l.a.createElement("div",null,l.a.createElement(D.a,{variant:"h6",component:"h2",classes:{root:ze.a.Title},style:{color:O.a.palette.purple}},t.title),l.a.createElement("div",{className:ze.a.Info},l.a.createElement(D.a,{variant:"subtitle2",component:"div",classes:{root:ze.a.Author}},l.a.createElement("span",{style:{fontFamily:O.a.typography.english}},"By")," ",t.author),l.a.createElement(ye,{text:"".concat(t.city," ").concat(t.countryCode)}),l.a.createElement("div",{style:{marginLeft:6}},l.a.createElement(de,{score:t.score||0,showScore:a.showScore,showNumerOfReviews:!1}))),l.a.createElement("div",{className:ze.a.Intro},l.a.createElement(P.a,{clamp:3},t.introduction))),l.a.createElement("div",{className:ze.a.ContentLeftBottom},l.a.createElement("div",{className:ze.a.CardActions},n&&n.map((function(e,t){return l.a.createElement(fe,{key:t,size:"small",text:e.trim(),callBackFunc:function(){return a.clickToSearch(e)},order:t})}))))),l.a.createElement("div",{className:ze.a.ContentRight},l.a.createElement(je,{order:a.order}),l.a.createElement("div",{className:ze.a.ContentRightBottom},l.a.createElement(D.a,{classes:{root:ze.a.Written},variant:"subtitle1",color:"textSecondary",component:"div"},"\u53d1\u8868\u4e8e"),l.a.createElement(D.a,{classes:{root:ze.a.Time},variant:"subtitle1",color:"textSecondary",component:"div"},t.written_date)))))))},Te=a(813),Ne=a.n(Te),xe=function(e){var t=e.results,a=e.searchClass,n=t&&t.reduce((function(e,t){return e[t.id]=l.a.createRef(),e}),{});return Object(s.useEffect)((function(){var e=I.a.subscribe("results.events.card.active",(function(e,t){var a=t.id;n[a].current&&window.scrollTo({top:n[a].current.offsetTop-n[a].current.clientHeight,left:0,behavior:"smooth"})}));return function(){I.a.unsubscribe(e)}})),l.a.createElement("div",{className:Ne.a.Container},t?l.a.createElement(N.a,{width:window.innerWidth>1376?640:560,height:window.innerHeight-120,rowHeight:196,rowCount:t.length,rowRenderer:function(e){var r=e.key,o=e.index,i=e.style,c=t[o];return l.a.createElement("div",{key:r,ref:n[c.id],style:i,className:Ne.a.VCard},l.a.createElement(Ie,{data:c,order:o+1,showScore:!1,clickToSearch:a}))},className:Ne.a.VList}):Object(M.a)(new Array(20)).map((function(e,t){return l.a.createElement("div",{key:t,className:Ne.a.Skeletons},l.a.createElement(T.a,{variant:"rect",className:Ne.a.Skeleton}))})))},Be=a(116),Pe=a(723),Ae=a(725),Ue=a(814),De=a.n(Ue),We=function(e){var t=e.data,a=e.searchClass,n=e.small,r=void 0!==n&&n,o=t.imageUrl,i=t.author,c=t.title,s=t.score,u=t.written_date,d=t.url,h=t.tag,m=h&&h.split(/\s*,|\s*\uff0c|\s+/);return l.a.createElement("div",{className:De.a.Container},l.a.createElement("a",{href:d,className:F.a.Link,target:"__blank",rel:"noopener noreferrer"},l.a.createElement("img",{src:o,width:r?"160":"200"}),l.a.createElement("div",{className:De.a.TitleRow},l.a.createElement(D.a,{classes:{root:De.a.Title},style:{color:O.a.palette.purple},variant:"h6",component:"span"},c)),l.a.createElement("div",{className:De.a.AuthorRow},l.a.createElement("div",{className:De.a.Author},i),l.a.createElement(de,{score:s||0,showScore:!1,showNumerOfReviews:!1}))),l.a.createElement("div",{className:De.a.TagRow},m&&m.map((function(e,t){return l.a.createElement(fe,{key:t,size:"small",text:e.trim(),extraCssClass:De.a.TagDiv,callBackFunc:function(){return a(e)},order:t})}))),l.a.createElement("div",{className:"".concat(De.a.FlexRow," ").concat(De.a.BottomRow)},l.a.createElement("div",null,l.a.createElement("span",{className:De.a.Publish,style:{color:O.a.palette.text.secondary}},"\u4e00\u8fb9\u5199\u8bd7\u4e00\u8fb9\u65c5\u884c")),l.a.createElement(D.a,{classes:{root:De.a.Time},style:{fontFamily:O.a.typography.english},variant:"subtitle2",color:"textSecondary",component:"div"},u)))},Fe=function(e){var t=e.id,a=(e.labelText,e.order),n=e.mapWidth,r=e.data,o=e.zoom,i=e.searchClass,c=Object(s.useState)(!1),u=Object(Pe.a)(c,2),d=u[0],h=u[1],m=r.lat,p=r.lng,f=Object(s.useRef)(null);Object(s.useEffect)((function(){function e(e,a){h(!1),a.id===t&&h(a.active)}var a=I.a.subscribe("results.events.marker.active",e),n=I.a.subscribe("results.events.card.active",e);return function(){I.a.unsubscribe(a),I.a.unsubscribe(n)}}),[t,n]);var g={url:d?"/icons/pika_dark.png":"/icons/pika.png",scaledSize:new google.maps.Size(18,18)},v=new google.maps.Size(0,-11);return g.scaledSize=o&&o>=8?new google.maps.Size(24,24):new google.maps.Size(18,18),l.a.createElement("div",{ref:f},l.a.createElement(Ae.c,{position:{lat:m,lng:p},icon:g,label:void 0,zIndex:d?999:a,onClick:function(){h(!0),I.a.publish("results.events.card.active",{id:t,active:!0})}},d&&l.a.createElement(Ae.b,{options:{pixelOffset:v},position:{lat:m,lng:p}},l.a.createElement(We,{data:r,searchClass:i,small:!!window.isMobile}))))},Ze=function(e){var t={mapTypeControl:!window.isMobile,gestureHandling:window.isMobile?"greedy":void 0,mapTypeControlOptions:{position:6},streetViewControl:!1,fullscreenControl:!1};return l.a.createElement(Ae.a,{onLoad:function(t){e.setMapRef(t)},options:t,mapContainerStyle:{width:"100%",height:"100%"},zoom:e.zoom||8,center:e.center,onZoomChanged:e.onZoomChanged,onBoundsChanged:Object(u.debounce)(e.onBoundsChanged,1e3)},e.children)},Ve=a(815),He=a.n(Ve),Qe=function(){return l.a.createElement("div",{className:He.a.Container},l.a.createElement("div",{className:He.a.Dot}),l.a.createElement("div",{className:He.a.Dot}),l.a.createElement("div",{className:He.a.Dot}))},Ge=a(816),qe=a.n(Ge),Je=function(e){var t=e.callBackFunc,a=e.isFetching;return l.a.createElement("div",{className:"".concat(qe.a.Container," ").concat(window.isMobile||!window.google?qe.a.Pos2:qe.a.Pos1),role:"button",onClick:function(e){e.preventDefault(),e.stopPropagation(),t&&t()}},a?l.a.createElement(Qe,null):"\u641c\u7d22\u8fd9\u7247\u533a\u57df")},Xe=a(817),Ke=a.n(Xe),Ye=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(a=Object(o.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).tokenPanTo=void 0,a.mapRef=void 0,a.state={zoom:9,center:{lat:35.676,lng:139.65}},a.handleMapPanToMarker=function(e,t){t.lat&&a.mapRef&&a.mapRef.panTo({lat:t.lat,lng:t.lng})},a.handleMapReCenter=function(e){a.setState({center:e,zoom:a.zoomBasedOnResults()},(function(){var e=a.state.zoom;a.mapRef&&a.mapRef.setZoom(e||8)}))},a.zoomBasedOnResults=function(){var e=localStorage.getItem("zoomLevelBeforeSearch");if(e&&"number"===typeof+e)return+e;var t=a.props.results;return t?t.length>=25?5:t.length>9?6:7:void 0},a.handleZoomChanged=function(){var e=Object(Be.a)(a).mapRef;e&&a.setState({zoom:e.getZoom(),center:e.getCenter()})},a.handleClickBoundsSearch=function(){a.props.searchClassInMap(a.mapRef.getBounds()),localStorage.setItem("zoomLevelBeforeSearch","".concat(a.mapRef.getZoom())),localStorage.setItem("centerBeforeSearch","".concat(a.mapRef.getCenter()))},a.handleBoundsChanged=function(){},a.setMapRef=function(e){a.mapRef=e},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.tokenPanTo=PubSub.subscribe("results.events.marker.active",this.handleMapPanToMarker)}},{key:"componentDidUpdate",value:function(e){if(e.results!==this.props.results){var t=localStorage.getItem("centerBeforeSearch");t?this.handleMapReCenter(t):this.handleMapReCenter(f(this.props.results))}}},{key:"componentWillUnmount",value:function(){PubSub.unsubscribe(this.tokenPanTo)}},{key:"render",value:function(){var e=this.props,t=e.results,a=e.mapWidth,n=e.isFetching,r=e.searchClass,o=this.state,i=o.zoom,c=o.center;return window.google?l.a.createElement(Ze,{center:c,onZoomChanged:this.handleZoomChanged,onBoundsChanged:this.handleBoundsChanged,setMapRef:this.setMapRef},t&&t.map((function(e,t){return l.a.createElement("div",{key:t},l.a.createElement("div",null,e.id),l.a.createElement(Fe,{zoom:i,id:e.id,data:e,labelText:"".concat(t+1),order:t,mapWidth:a,searchClass:r}))})),this.mapRef&&l.a.createElement(Je,{isFetching:n,callBackFunc:this.handleClickBoundsSearch})):l.a.createElement("div",{className:Ke.a.GoogleUnavailable},l.a.createElement("h2",{className:Ke.a.Can},"\u60e8\u3002\u8c37\u6b4c\u5730\u56fe\u4e0d\u53ef\u7528\u3002"),l.a.createElement("div",null,"Google Maps is not available in your region."),l.a.createElement("h3",null,"\u8bd5\u8bd5\u641c\u7d22\u6587\u7ae0\u5427\uff5e"))}}]),t}(s.PureComponent),$e=a(841),et=a(842),tt=(a(843),a(639)),at=a.n(tt),nt=a(818),rt=a.n(nt),ot=new at.a.Icon({iconUrl:a(664),iconRetinaUrl:a(664),iconAnchor:void 0,popupAnchor:[0,-5],shadowUrl:void 0,shadowSize:void 0,shadowAnchor:void 0,iconSize:new at.a.Point(24,24),className:rt.a.Icon}),it=new at.a.Icon({iconUrl:a(665),iconRetinaUrl:a(665),iconAnchor:void 0,popupAnchor:[0,-5],shadowUrl:void 0,shadowSize:void 0,shadowAnchor:void 0,iconSize:new at.a.Point(24,24),className:rt.a.IconActive}),ct=new at.a.Icon({iconUrl:a(664),iconRetinaUrl:a(664),iconAnchor:void 0,popupAnchor:[0,-5],shadowUrl:void 0,shadowSize:void 0,shadowAnchor:void 0,iconSize:new at.a.Point(15,15),className:rt.a.Icon}),st=new at.a.Icon({iconUrl:a(665),iconRetinaUrl:a(665),iconAnchor:void 0,popupAnchor:[0,-5],shadowUrl:void 0,shadowSize:void 0,shadowAnchor:void 0,iconSize:new at.a.Point(15,15),className:rt.a.IconActive}),lt=new at.a.Icon({iconUrl:a(714),iconRetinaUrl:a(714),iconAnchor:void 0,popupAnchor:[0,-5],shadowUrl:void 0,shadowSize:void 0,shadowAnchor:void 0,iconSize:new at.a.Point(6,6),className:rt.a.Icon}),ut=new at.a.Icon({iconUrl:a(715),iconRetinaUrl:a(715),iconAnchor:void 0,popupAnchor:[0,-5],shadowUrl:void 0,shadowSize:void 0,shadowAnchor:void 0,iconSize:new at.a.Point(6,6),className:rt.a.IconActive}),dt=(a(819),l.a.forwardRef((function(e,t){var a=Object(s.useState)(!1),n=Object(Pe.a)(a,2),r=n[0],o=n[1],i=e.id,c=(e.labelText,e.order),u=e.mapWidth,d=e.data,h=e.zoom,m=e.searchClass,p=d.lat,f=d.lng;Object(s.useEffect)((function(){function e(e,t){o(!1),t.id===i&&o(t.active)}var t=I.a.subscribe("results.events.marker.active",e),a=I.a.subscribe("results.events.card.active",e);return function(){I.a.unsubscribe(t),I.a.unsubscribe(a)}}),[i,u]);var g=ot;return g=!h||h>=8?r?it:ot:7===h?r?st:ct:r?ut:lt,l.a.createElement($e.a,{position:[p,f],icon:g,style:{zIndex:r?999:c},ref:function(e){return t(e,d.id)},onclick:function(){o(!0),I.a.publish("results.events.card.active",{id:i,active:!0})}},l.a.createElement(et.a,{position:[p,f]},l.a.createElement(We,{data:d,searchClass:m,small:!!window.isMobile})),!1)}))),ht=a(847),mt=a(848);delete at.a.Icon.Default.prototype._getIconUrl,at.a.Icon.Default.mergeOptions({iconRetinaUrl:a(820),iconUrl:a(821),shadowUrl:a(822)});var pt=function(e){var t=e.center,a=e.zoom,n=void 0===a?8:a,r=Object(x.a)(e,["center","zoom"]),o=[t.lat,t.lng];return l.a.createElement(ht.a,{onzoomend:r.onZoomEnd,dragging:!0,ref:r.setMapRef,center:o,zoom:n},l.a.createElement(mt.a,{url:"https://www.google.cn/maps/vt?lyrs=m@189&gl=cn&x={x}&y={y}&z={z}",attribution:"Map data \xa9 Google | Made with \u2665 in 2020"}),r.children)},ft=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(a=Object(o.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).tokenPanTo=void 0,a.mapRef=void 0,a.resizeTimeout=void 0,a.markerRefs={},a.state={zoom:9,center:{lat:35.676,lng:139.65}},a.handleMapPanToMarker=function(e,t){t.lat&&(a.mapRef&&a.mapRef.leafletElement.panTo([t.lat,t.lng]),a.markerRefs[t.id]&&a.markerRefs[t.id].leafletElement.openPopup())},a.handleMapReCenter=function(e){a.setState({center:e,zoom:a.zoomBasedOnResults()})},a.zoomBasedOnResults=function(){var e=a.props.firstLoad,t=localStorage.getItem("zoomLevelBeforeSearch");if(t&&"number"===typeof+t)return+t;var n=a.props.results;return e?8:n?n.length>=25?5:n.length>9?6:7:void 0},a.handleZoomChanged=function(){var e=Object(Be.a)(a).mapRef;if(e){var t=e.leafletElement.getCenter();a.setState({zoom:e.leafletElement.getZoom(),center:{lat:t.lat,lng:t.lng}})}},a.handleClickBoundsSearch=function(){a.props.searchClassInMap(a.mapRef.leafletElement.getBounds());var e=a.mapRef.leafletElement.getCenter();localStorage.setItem("zoomLevelBeforeSearch","".concat(a.mapRef.leafletElement.getZoom())),localStorage.setItem("centerBeforeSearch","".concat(JSON.stringify(e)))},a.handleBoundsChanged=function(){},a.setMapRef=function(e){a.mapRef=e},a.setMarkerRef=function(e,t){a.markerRefs[t]=e},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.tokenPanTo=PubSub.subscribe("results.events.marker.active",this.handleMapPanToMarker),this.resizeTimeout=setTimeout((function(){return window.dispatchEvent(new Event("resize"))}))}},{key:"componentDidUpdate",value:function(e){if(e.results!==this.props.results){var t=localStorage.getItem("centerBeforeSearch");t?this.handleMapReCenter(JSON.parse(t)):this.handleMapReCenter(f(this.props.results))}}},{key:"componentWillUnmount",value:function(){clearTimeout(this.resizeTimeout),PubSub.unsubscribe(this.tokenPanTo)}},{key:"render",value:function(){var e=this,t=this.props,a=t.results,n=t.mapWidth,r=t.isFetching,o=t.searchClass,i=this.state,c=i.zoom,s=i.center;return l.a.createElement(pt,{zoom:c,setMapRef:this.setMapRef,center:s||{lat:35.676,lng:139.65},onZoomEnd:this.handleZoomChanged},a&&a.map((function(t,a){return l.a.createElement("div",{key:a},l.a.createElement(dt,{zoom:c,id:t.id,data:t,labelText:"".concat(a+1),order:a,mapWidth:n,searchClass:o,ref:e.setMarkerRef}))})),this.mapRef&&l.a.createElement(Je,{isFetching:r,callBackFunc:this.handleClickBoundsSearch}))}}]),t}(s.PureComponent),gt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(i.a)(t).call(this,e))).state={hasError:!1},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidCatch",value:function(e,t){}},{key:"render",value:function(){return this.state.hasError?l.a.createElement("h1",null,this.props.errorMessage||"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(l.a.Component),vt=a(119),Ct=a(100),_t=a.n(Ct),bt=a(87);function wt(){return{type:bt.b,fetching:!0}}function Rt(e){return{type:bt.c,fetching:!1,postsData:e}}function Et(e){return{type:bt.a,fetching:!1,errorMessage:e}}var yt=function(e){return function(t){return t(wt()),_t.a.get("https://2vpgvmhzzi.execute-api.ap-northeast-1.amazonaws.com/dev/posts",{params:{search:e}}).then((function(e){t(Rt(e.data.body))})).catch((function(e){t(Et(String(e)))}))}},St=function(e){return function(t){var a;return window.google&&e instanceof google.maps.LatLngBounds?a={search_by_map:!0,ne_lat:e.getNorthEast().lat(),ne_lng:e.getNorthEast().lng(),sw_lat:e.getSouthWest().lat(),sw_lng:e.getSouthWest().lng()}:e instanceof at.a.LatLngBounds&&(a={search_by_map:!0,ne_lat:e.getNorthEast().lat,ne_lng:e.getNorthEast().lng,sw_lat:e.getSouthWest().lat,sw_lng:e.getSouthWest().lng}),t(wt()),_t.a.get("https://2vpgvmhzzi.execute-api.ap-northeast-1.amazonaws.com/dev/posts",{params:a}).then((function(e){t(Rt(e.data.body))})).catch((function(e){t(Et(String(e)))}))}},Ot=a(823),kt=a.n(Ot),Lt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(i.a)(t).call(this,e))).rightRailRef=void 0,a.state={rightRailWidth:"100%",searchString:g(a.props.location.search).q||"\u65e5\u672c",listView:!0,firstLoad:!0},a.updateMapContainerSize=function(){a.rightRailRef.current&&a.setState({rightRailWidth:a.rightRailRef.current.offsetWidth})},a.handleUpdateSearchQs=function(e){a.props.history.push({search:e.length>0?"?q=".concat(e):""})},a.handleListViewToggle=function(){a.setState((function(e){return{listView:!e.listView}}),a.updateMapContainerSize),window.dispatchEvent(new Event("resize"))},a.searchClass=function(e){a.props.dispatch(yt(e)),a.setState({searchString:e,firstLoad:!1}),a.handleUpdateSearchQs(e),a.clearStoredCenterAndZoom(),Object(m.b)({category:"ResultPage",label:"".concat(e),action:"search"})},a.clearStoredCenterAndZoom=function(){localStorage.removeItem("zoomLevelBeforeSearch"),localStorage.removeItem("centerBeforeSearch")},a.searchClassInMap=function(e){a.props.dispatch(St(e)),a.setState({searchString:"",firstLoad:!1}),Object(m.b)({category:"ResultPage",label:"map interaction",action:"search"})},a.debouncedUpdateMapContainerSize=Object(u.debounce)(a.updateMapContainerSize,500),a.rightRailRef=l.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.debouncedUpdateMapContainerSize),this.updateMapContainerSize();var e=g(this.props.location.search);"string"===typeof e.q?this.props.dispatch(yt(e.q)):this.props.posts||this.props.dispatch(function(e){return function(t,a){if(function(e){var t=e.posts?e.posts.postsData:null;return!(t&&t.fetching)}(a()))return t(yt(e))}}("\u65e5\u672c")),this.clearStoredCenterAndZoom()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.debouncedUpdateMapContainerSize)}},{key:"render",value:function(){var e=this.state,t=e.rightRailWidth,a=e.searchString,n=e.listView,r=e.firstLoad,o=this.props,i=o.posts,c=o.isFetching,s=l.a.createElement(ft,{results:i,mapWidth:t,searchClass:this.searchClass,searchClassInMap:this.searchClassInMap,isFetching:c,firstLoad:r});return window.google&&(s=l.a.createElement(Ye,{results:i,mapWidth:t,searchClass:this.searchClass,searchClassInMap:this.searchClassInMap,isFetching:c})),l.a.createElement("div",{className:kt.a.Container},l.a.createElement("div",{className:kt.a.SearchBar},l.a.createElement("div",{className:kt.a.Bar},l.a.createElement(R,{searchClass:this.searchClass,handleUpdateSearchQs:this.handleUpdateSearchQs})),l.a.createElement("div",{className:kt.a.Bar},l.a.createElement(j,{listView:n,searchString:a,num:i&&i.length,isFetching:c,handleListViewToggle:this.handleListViewToggle}))),l.a.createElement("div",{className:"".concat(kt.a.Results," ").concat(n?kt.a.ResultsWrap:"")},!window.isMobile&&l.a.createElement("div",{className:"".concat(kt.a.ResultsList," ").concat(n?"":kt.a.ListHidden)},l.a.createElement(xe,{results:i,searchClass:this.searchClass})),l.a.createElement("div",{ref:this.rightRailRef,className:kt.a.RightRail},l.a.createElement("div",{style:{width:t},className:kt.a.ResultsMap},l.a.createElement(gt,{errorMessage:"\u6709\u70b9\u95ee\u9898"},s)))))}}]),t}(s.Component);t.default=Object(h.b)((function(e){var t=e.posts;return{posts:t.postsData,isFetching:t.fetching}}),(function(e){return{dispatch:e}}))(Object(d.g)(Object(vt.a)(Lt)))}}]);
//# sourceMappingURL=5.d38f1623.chunk.js.map